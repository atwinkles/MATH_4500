Here is my code:
--------------------------------------------------------------------------
type gaussianelim.m

function x = gaussianelim(q1,A,p,b,q2)
%function x = gaussianelim(A,b,p,q)
%
%This is an algorithm made by Alexander Winkles to manipulate linear 
%systems to solve various problems involving matrices and problems of the
%form Ax = b.
%
%A  : the matrix
%b  : the vector (optional)
%p  : the permutation of the matrix, where (1,2,...,n) is the given matrix
%q1 : controls what method is used to solve problem at hand
%       if b exists:
%           q == 1 - Gaussian elimination
%           q == 2 - LU factorization
%           q == 3 - Scaled row pivoting
%       if b does not exist:
%           q == 1 - returns an inverse matrix
%           q == 2 - computes the determinant (in progress)
%q2 : displays intermediate matrices (optional)

if size(A,1) ~= size(A,2)
    fprintf('\nThis matrix is not square!\n\n')
elseif det(A) < 1e-14
    fprintf('\nThis matrix is singular!\n\n')
else
    n = size(A,1);
    A1 = A;
    
%%% Gaussian elimination %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    if exist('b','var')
        if q1 == 1
        
            %Performs the Gaussian elimination to create an upper triangular
            %matrix A
        
            for k=1:n-1
                for i=k+1:n
                    b(i) = b(i) - (A(p(i),k)/A(p(k),k))*b(k);
                    z = A(p(i),k)/A(p(k),k);
                    A(p(i),k) = 0;
                    for j = k+1:n
                        A(p(i),j) = A(p(i),j) - z*A(p(k),j);
                    end;
                end;
            end;
        
            if exist('q2','var')
                fprintf('\nThe row reduced matrix is:\n\n')
                disp(A);
            end;
        
            %Solves the system Ax = b with new matrix A

            for i=n:-1:1
                sum = 0;
                for j=i+1:n
                    sum = sum + A(p(i),j)*x(j);
                end;
                x(i,1) = (b(i) - sum)/A(p(i),i);
            end;
    
        end;
    
%%% LU factorization %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
        if q1 == 2 
            U = zeros(n,n);
            L = zeros(n,n);
            for i=1:n
                L(i,i) = 1;
                for j=i:n
                    sum = 0;
                    for k=1:i-1
                        sum = sum + L(i,k)*U(k,j);
                    end;
                
                    U(i,j) = A(i,j) - sum;
                end;
                for j=i+1:n
                    sum = 0;
                    for k=1:i-1
                        sum = sum + L(j,k)*U(k,i);
                    end;
                
                    L(j,i) = (A(j,i) - sum)/U(i,i);
                end;
            end;
        
        %Solves the system using LU results
        
            x = zeros(n,1);
            for i=1:n
                sum = 0;
                for j=1:i-1
                    sum = sum + L(i,j)*z(j);
                end;
                z(i) = b(p(i)) - sum;
            end;
       
            for i = n:-1:1
                sum = 0;
                for j=i+1:n
                    sum = sum + U(i,j)*x(j);
                end;
                x(i) = (z(i) - sum)/U(i,i);
            end;
        
            if exist('q2','var')
                fprintf('\nThe L matrix is:\n')
                disp(L)
                fprintf('\nThe U matrix is:\n')
                disp(U)
            end;
        end;
    
%%% Scaled row pivoting %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
        if q1 == 3
            for i=1:n
                p(i) = i;
                s = max(abs(A'));
            end;
            for k=1:n-1
                r = abs(A(p(k),k)/s(p(k)));
                kp = k;
                for i = (k+1):n
                    t = abs(A(p(i),k)/s(p(i)));
                    if t > r, r = t; kp = i; end;
                end;
                l = p(kp); p(kp) = p(k); p(k) = l;
                for i = (k+1):n
                    A(p(i),k) = A(p(i),k)/A(p(k),k);
                    for j = (k+1):n
                        A(p(i),j) = A(p(i),j)-A(p(i),k)*A(p(k),j);
                    end;
                end;
            end;
        
            y = zeros(n,1);
            y(1) = b(p(1));
            for i = 2:n
                y(i) = b(p(i));
                for j = 1:(i-1)
                    y(i) = y(i)-A(p(i),j)*y(j);
                end;
            end;
        
            x = zeros(n,1);
            x(n) = y(n)/A(p(n),n);
            for i = (n-1):-1:1
                x(i) = y(i);
                for j = (i+1):n
                    x(i) = x(i) - A(p(i),j)*x(j);
                end;
                x(i) = x(i)/A(p(i),i);
            end;
        
            P = zeros(n,n);
            for i=1:length(p)
                for j=1:length(p)
                    if j == p(i)
                        P(i,j) = 1;
                    end;
                end;
            end;

            K = P*A1;
        
            [L,U] = lufactor(K,1);
        
            if exist('q2','var')
                fprintf('\nThe L matrix is:\n')
                disp(L)
                fprintf('\nThe U matrix is:\n')
                disp(U)
            end;
        
        end;
        
%%% Inverse matrix generator %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%        
        
    else
        if q1 == 1
            I = eye(n);
            for k=1:n-1
                for i=k+1:n
                    z = A(p(i),k)/A(p(k),k);
                    for j = 1:n
                        A(p(i),j) = A(p(i),j) - z*A(p(k),j);
                        I(p(i),j) = I(p(i),j) - z*I(p(k),j);
                    end;
                end;
            end;
            for k=n:-1:1
                for i=k-1:-1:1
                    z = A(p(i),k)/A(p(k),k);
                    for j = n:-1:1
                        A(p(i),j) = A(p(i),j) - z*A(p(k),j);
                        I(p(i),j) = I(p(i),j) - z*I(p(k),j);
                    end;
                end;
            end;
            for i=1:n
                for j=1:n
                    I(p(i),j) = I(p(i),j)/A(p(i),p(i));
                end;
                A(p(i),p(i)) = 1;
            end;
            x = I;
        end;
        
    end;
end;
--------------------------------------------------------------------------
*** Problem 1 ************************************************************

A = rand(10)

A =

    0.6999    0.9686    0.2810    0.6761    0.7805    0.7702    0.6074    0.5762    0.7093    0.4162
    0.6385    0.5313    0.4401    0.2891    0.6753    0.3225    0.1917    0.6834    0.2362    0.8419
    0.0336    0.3251    0.5271    0.6718    0.0067    0.7847    0.7384    0.5466    0.1194    0.8329
    0.0688    0.1056    0.4574    0.6951    0.6022    0.4714    0.2428    0.4257    0.6073    0.2564
    0.3196    0.6110    0.8754    0.0680    0.3868    0.0358    0.9174    0.6444    0.4501    0.6135
    0.5309    0.7788    0.5181    0.2548    0.9160    0.1759    0.2691    0.6476    0.4587    0.5822
    0.6544    0.4235    0.9436    0.2240    0.0012    0.7218    0.7655    0.6790    0.6619    0.5407
    0.4076    0.0908    0.6377    0.6678    0.4624    0.4735    0.1887    0.6358    0.7703    0.8699
    0.8200    0.2665    0.9577    0.8444    0.4243    0.1527    0.2875    0.9452    0.3502    0.2648
    0.7184    0.1537    0.2407    0.3445    0.4609    0.3411    0.0911    0.2089    0.6620    0.3181

U = triu(A)

U =

    0.6999    0.9686    0.2810    0.6761    0.7805    0.7702    0.6074    0.5762    0.7093    0.4162
         0    0.5313    0.4401    0.2891    0.6753    0.3225    0.1917    0.6834    0.2362    0.8419
         0         0    0.5271    0.6718    0.0067    0.7847    0.7384    0.5466    0.1194    0.8329
         0         0         0    0.6951    0.6022    0.4714    0.2428    0.4257    0.6073    0.2564
         0         0         0         0    0.3868    0.0358    0.9174    0.6444    0.4501    0.6135
         0         0         0         0         0    0.1759    0.2691    0.6476    0.4587    0.5822
         0         0         0         0         0         0    0.7655    0.6790    0.6619    0.5407
         0         0         0         0         0         0         0    0.6358    0.7703    0.8699
         0         0         0         0         0         0         0         0    0.3502    0.2648
         0         0         0         0         0         0         0         0         0    0.3181

b = rand(10,1)

b =

    0.1192
    0.9398
    0.6456
    0.4795
    0.6393
    0.5447
    0.6473
    0.5439
    0.7210
    0.5225

x = gaussianelim(1,U,1:10,b)

x =

   -6.4232
    4.2516
   -3.6645
   -0.6708
   -0.7670
    2.6291
    1.0917
   -2.3819
    0.8169
    1.6427

U*x - b

ans =

   1.0e-15 *

   -0.6661
    0.6661
    0.1110
         0
         0
   -0.1110
    0.1110
   -0.3331
         0
         0

*** Problem 2 ************************************************************

A = rand(10)

A =

    0.9937    0.7720    0.4849    0.7549    0.0196    0.3968    0.8335    0.4070    0.4952    0.8154
    0.2187    0.9329    0.3935    0.2428    0.3309    0.8085    0.7689    0.7487    0.1897    0.8790
    0.1058    0.9727    0.6714    0.4424    0.4243    0.7551    0.1673    0.8256    0.4950    0.9889
    0.1097    0.1920    0.7413    0.6878    0.2703    0.3774    0.8620    0.7900    0.1476    0.0005
    0.0636    0.1389    0.5201    0.3592    0.1971    0.2160    0.9899    0.3185    0.0550    0.8654
    0.4046    0.6963    0.3477    0.7363    0.8217    0.7904    0.5144    0.5341    0.8507    0.6126
    0.4484    0.0938    0.1500    0.3947    0.4299    0.9493    0.8843    0.0900    0.5606    0.9900
    0.3658    0.5254    0.5861    0.6834    0.8878    0.3276    0.5880    0.1117    0.9296    0.5277
    0.7635    0.5303    0.2621    0.7040    0.3912    0.6713    0.1548    0.1363    0.6967    0.4795
    0.6279    0.8611    0.0445    0.4423    0.7691    0.4386    0.1999    0.6787    0.5828    0.8013

L = tril(A)

L =

    0.9937         0         0         0         0         0         0         0         0         0
    0.2187    0.9329         0         0         0         0         0         0         0         0
    0.1058    0.9727    0.6714         0         0         0         0         0         0         0
    0.1097    0.1920    0.7413    0.6878         0         0         0         0         0         0
    0.0636    0.1389    0.5201    0.3592    0.1971         0         0         0         0         0
    0.4046    0.6963    0.3477    0.7363    0.8217    0.7904         0         0         0         0
    0.4484    0.0938    0.1500    0.3947    0.4299    0.9493    0.8843         0         0         0
    0.3658    0.5254    0.5861    0.6834    0.8878    0.3276    0.5880    0.1117         0         0
    0.7635    0.5303    0.2621    0.7040    0.3912    0.6713    0.1548    0.1363    0.6967         0
    0.6279    0.8611    0.0445    0.4423    0.7691    0.4386    0.1999    0.6787    0.5828    0.8013

b = rand(10,1)

b =

    0.2278
    0.4981
    0.9009
    0.5747
    0.8452
    0.7386
    0.5860
    0.2467
    0.6664
    0.0835

x = gaussianelim(1,L,1:10,b)

x =

    0.2293
    0.4802
    0.6099
    0.0076
    2.2533
   -2.2238
    1.6804
  -24.2795
    5.3567
   14.6723

L*x - b

ans =

   1.0e-14 *

         0
         0
   -0.0111
   -0.0111
   -0.0111
   -0.0222
   -0.0444
         0
   -0.0111
    0.1152

*** Problem 3 ************************************************************

A = rand(10)

A =

    0.6260    0.1209    0.0495    0.5386    0.2085    0.6210    0.8589    0.3329    0.1771    0.4145
    0.6609    0.8627    0.4896    0.6952    0.5650    0.5737    0.7856    0.4671    0.6628    0.4648
    0.7298    0.4843    0.1925    0.4991    0.6403    0.0521    0.5134    0.6482    0.3308    0.7640
    0.8908    0.8449    0.1231    0.5358    0.4170    0.9312    0.1776    0.0252    0.8985    0.8182
    0.9823    0.2094    0.2055    0.4452    0.2060    0.7287    0.3986    0.8422    0.1182    0.1002
    0.7690    0.5523    0.1465    0.1239    0.9479    0.7378    0.1339    0.5590    0.9884    0.1781
    0.5814    0.6299    0.1891    0.4904    0.0821    0.0634    0.0309    0.8541    0.5400    0.3596
    0.9283    0.0320    0.0427    0.8530    0.1057    0.8604    0.9391    0.3479    0.7069    0.0567
    0.5801    0.6147    0.6352    0.8739    0.1420    0.9344    0.3013    0.4460    0.9995    0.5219
    0.0170    0.3624    0.2819    0.2703    0.1665    0.9844    0.2955    0.0542    0.2878    0.3358

b = rand(10,1)

b =

    0.1757
    0.2089
    0.9052
    0.6754
    0.4685
    0.9121
    0.1040
    0.7455
    0.7363
    0.5619

x = gaussianelim(3,A,1:10,b)

x =

   -1.8115
   -0.7188
   -2.8479
    7.3397
    4.6908
    1.0005
   -3.5718
   -0.2116
   -2.1941
   -1.1765

A*x - b

ans =

   1.0e-14 *

    0.1471
    0.0971
    0.0555
   -0.0333
   -0.0056
         0
    0.0125
    0.0444
    0.0666
    0.0333

*** Problem 4 ************************************************************

A = rand(5)

A =

    0.1544    0.3508    0.5975    0.3596    0.1249
    0.3813    0.6855    0.3353    0.5583    0.0244
    0.1611    0.2941    0.2992    0.7425    0.2902
    0.7581    0.5306    0.4526    0.4243    0.3175
    0.8711    0.8324    0.4226    0.4294    0.6537

Ainverse = gaussianelim(1,A,1:5)

Ainverse =

   -1.2097   -0.2611   -0.3099    3.0050   -1.0812
    0.2861    1.8224   -0.9472   -2.5250    1.5242
    2.2946   -0.8512   -0.5513    0.5974   -0.4520
   -0.9193    0.3143    1.6673    0.7624   -0.9466
    0.3679   -1.6288    0.8805   -1.6761    1.9437

A*Ainverse

ans =

    1.0000    0.0000    0.0000   -0.0000   -0.0000
   -0.0000    1.0000    0.0000   -0.0000   -0.0000
   -0.0000   -0.0000    1.0000    0.0000   -0.0000
    0.0000   -0.0000    0.0000    1.0000   -0.0000
   -0.0000   -0.0000    0.0000   -0.0000    1.0000

Ainverse*A

ans =

    1.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000    1.0000   -0.0000   -0.0000   -0.0000
    0.0000    0.0000    1.0000    0.0000    0.0000
    0.0000    0.0000    0.0000    1.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    1.0000

diary off
