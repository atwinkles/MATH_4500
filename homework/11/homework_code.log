Here is my code:
--------------------------------------------------------------------------
type gaussianelim.m

function x = gaussianelim(A,b,p,q)
%This is an algorithm made by Alexander Winkles to solve problems of the
%form Ax = b using Gaussian elimination in various settings.
%
%A  : the matrix
%b  : the vector
%p  : the permutation of the matrix, where (1,2,...,n) is the given matrix
%q  : indication which way the system is to be solved
%       q == 1 - Gaussian elimination (currently not working)
%       q == 2 - LU factorization
%       q == 3 - Scaled row pivoting

if size(A,1) ~= size(A,2)
    fprintf('This matrix is not square!')
else
    n = size(A,1);
    A1 = A;
%%% Gaussian elimination %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    if q == 1
        
        %Performs the Gaussian elimination to create an upper triangular
        %matrix A
        
        for k=1:n-1
            for i=k+1:n
                z = A(p(i),k)/A(p(k),k);
                A(p(i),k) = 0;
                for j = k+1:n
                    A(p(i),j) = A(p(i),j) - z*A(p(k),j);
                end;
            end;
        end;
        
        %Solves the system Ax = b with new matrix A
    
        for i = 1:n %(error somewhere here)
            sum = 0;
            for j = 1:i-1
                sum = sum + A(p(i),j)*z(j);
            end;
            z(i) = b(p(i)) - sum;
        end;
        disp(z)
    
        for i=n:-1:1
            sum = 0;
            for j=i+1:n
                sum = sum + A(p(i),j)*x(j);
            end;
            x(i) = (z(i) - sum)/A(p(i),i);
        end;
    
    end;
    
%%% LU factorization %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    if q == 2 
        U = zeros(n,n);
        L = zeros(n,n);
        for i=1:n
            L(i,i) = 1;
            for j=i:n
                sum = 0;
                for k=1:i-1
                    sum = sum + L(i,k)*U(k,j);
                end;
                
                U(i,j) = A(i,j) - sum;
            end;
            for j=i+1:n
                sum = 0;
                for k=1:i-1
                    sum = sum + L(j,k)*U(k,i);
                end;
                
                L(j,i) = (A(j,i) - sum)/U(i,i);
            end;
        end;
        
        %Solves the system using LU results
        
        x = zeros(n,1);
        for i=1:n
            sum = 0;
            for j=1:i-1
                sum = sum + L(i,j)*z(j);
            end;
            z(i) = b(p(i)) - sum;
        end;
        for i = n:-1:1
            sum = 0;
            for j=i+1:n
                sum = sum + U(i,j)*x(j);
            end;
            x(i) = (z(i) - sum)/U(i,i);
        end;
        fprintf('\nThe L matrix is:\n')
        disp(L)
        fprintf('\nThe U matrix is:\n')
        disp(U)
    end;
    
%%% Scaled row pivoting %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    if q == 3
        % factorization phase
        for i=1:n
            p(i) = i;
            s = max(abs(A'));
        end;
        for k=1:n-1
            r = abs(A(p(k),k)/s(p(k)));
            kp = k;
            for i = (k+1):n
                t = abs(A(p(i),k)/s(p(i)));
                if t > r, r = t; kp = i; end;
            end;
            l = p(kp); p(kp) = p(k); p(k) = l;
            for i = (k+1):n
                A(p(i),k) = A(p(i),k)/A(p(k),k);
                for j = (k+1):n
                    A(p(i),j) = A(p(i),j)-A(p(i),k)*A(p(k),j);
                end;
            end;
        end;
        
        y = zeros(n,1);
        y(1) = b(p(1));
        for i = 2:n
            y(i) = b(p(i));
            for j = 1:(i-1)
                y(i) = y(i)-A(p(i),j)*y(j);
            end;
        end;
        
        x = zeros(n,1);
        x(n) = y(n)/A(p(n),n);
        for i = (n-1):-1:1
            x(i) = y(i);
            for j = (i+1):n
                x(i) = x(i) - A(p(i),j)*x(j);
            end;
            x(i) = x(i)/A(p(i),i);
        end;
        
        P = zeros(n,n);
        for i=1:length(p)
            for j=1:length(p)
                if j == p(i)
                    P(i,j) = 1;
                end;
            end;
        end;
        
        K = P*A1;
        
        [L,U] = lufactor(K,1);
        
        fprintf('\nThe L matrix is:\n')
        disp(L)
        fprintf('\nThe U matrix is:\n')
        disp(U)
        
    end;
    
end;
--------------------------------------------------------------------------

Problem 1:

part A:
A = [-1 1 -4; 2 2 0; 3 3 2];
a = [0 1 1/2];
gaussianelim(A,a,[1 2 3], 2)

The L matrix is:
    1.0000         0         0
   -2.0000    1.0000         0
   -3.0000    1.5000    1.0000


The U matrix is:
    -1     1    -4
     0     4    -8
     0     0     2


ans =

    1.2500
   -0.7500
   -0.5000

gaussianelim(A,a,[1 2 3], 3)

The L matrix is:
    1.0000         0         0
   -0.5000    1.0000         0
    1.5000         0    1.0000


The U matrix is:
     2     2     0
     0     2    -4
     0     0     2


ans =

    1.2500
   -0.7500
   -0.5000

part B:
B = [1 6 0; 2 1 0; 0 2 1];
b = [3 1 1];
format rat
gaussianelim(B,b,[1 2 3], 2)

The L matrix is:
       1              0              0       
       2              1              0       
       0             -2/11           1       


The U matrix is:
       1              6              0       
       0            -11              0       
       0              0              1       


ans =

       3/11    
       5/11    
       1/11    

gaussianelim(B,b,[1 2 3], 3)

The L matrix is:
       1              0              0       
       0              1              0       
       1/2           11/4            1       


The U matrix is:
       2              1              0       
       0              2              1       
       0              0            -11/4     


ans =

       3/11    
       5/11    
       1/11    

part C:
C = [-1 1 0 -3; 1 0 3 1; 0 1 -1 -1; 3 0 1 2];
c = [4 0 3 1];
gaussianelim(C,c,[1 2 3 4], 2)

The L matrix is:
       1              0              0              0       
      -1              1              0              0       
       0              1              1              0       
      -3              3              2              1       


The U matrix is:
      -1              1              0             -3       
       0              1              3             -2       
       0              0             -4              1       
       0              0              0             -3       


ans =

       1       
       2       
       0       
      -1       

gaussianelim(C,c,[1 2 3 4], 3)

The L matrix is:
       1              0              0              0       
       0              1              0              0       
       1/3            0              1              0       
      -1/3            1              1/2            1       


The U matrix is:
       3              0              1              2       
       0              1             -1             -1       
       0              0              8/3            1/3     
       0              0              0             -3/2     


ans =

       1       
       2       
      -1/48038396025285288
      -1       

part D:
D = [6 -2 2 4; 12 -8 4 10; 3 -13 3 3; -6 4 2 -18];
d = [0 -10 -39 -16];
gaussianelim(D,d,[1 2 3 4], 2)

The L matrix is:
       1              0              0              0       
       2              1              0              0       
       1/2            3              1              0       
      -1             -1/2            2              1       


The U matrix is:
       6             -2              2              4       
       0             -4              0              2       
       0              0              2             -5       
       0              0              0             -3       


ans =

       1       
       3       
      -2       
       1       

gaussianelim(D,d,[1 2 3 4], 3)

The L matrix is:
       1              0              0              0       
       1/2            1              0              0       
      -1             -1/6            1              0       
       2              1/3           -2/13           1       


The U matrix is:
       6             -2              2              4       
       0            -12              2              1       
       0              0             13/3          -83/6     
       0              0              0             -6/13    


ans =

       1       
       3       
      -2       
       1       

part E:
E = [1 0 2 1; 4 -9 2 1; 8 16 6 5; 2 3 2 1];
e = [2 14 -3 0];
gaussianelim(E,e,[1 2 3 4], 2)

The L matrix is:
       1              0              0              0       
       4              1              0              0       
       8            -16/9            1              0       
       2             -1/3            6/31           1       


The U matrix is:
       1              0              2              1       
       0             -9             -6             -3       
       0              0            -62/3          -25/3     
       0              0              0            -12/31    


ans =

       1       
      -1       
       1/1939049839562297
       1       

gaussianelim(E,e,[1 2 3 4], 3)

The L matrix is:
       1              0              0              0       
       2              1              0              0       
       1/2            1/10           1              0       
       4             -4/15         -19/9            1       


The U matrix is:
       2              3              2              1       
       0            -15             -2             -1       
       0              0              6/5            3/5     
       0              0              0              2       


ans =

       1       
      -1       
       0       
       1       

Problem 21: 

format long
K = [0.2641 0.1735 0.8642; 0.9411 0.0175 0.1463; -0.8641 -0.4243 0.0711];
k = [-0.7521 0.6310 0.2501];
format long
gaussianelim(K,k,[1 2 3 4], 2)

The L matrix is:
   1.000000000000000                   0                   0
   3.563422945853843   1.000000000000000                   0
  -3.271866717152593  -0.238648271671779   1.000000000000000


The U matrix is:
   0.264100000000000   0.173500000000000   0.864200000000000
                   0  -0.600753881105642  -2.933210109806891
                   0                   0   2.198641693807667


ans =

   0.814757689669357
  -2.356983928355609
  -0.646078216005530

gaussianelim(K,k,[1 2 3], 3)

The L matrix is:
   1.000000000000000                   0                   0
  -0.918180852194241   1.000000000000000                   0
   0.280629051110403  -0.412973651527701   1.000000000000000


The U matrix is:
   0.941100000000000   0.017500000000000   0.146300000000000
                   0  -0.408231835086601   0.205429858676017
                   0                   0   0.907981088692803


ans =

   0.814757689669357
  -2.356983928355609
  -0.646078216005530

Problem 29:

gaussianelim(Q,[1 1 1 1],[1 2 3 4],3)
     0     0     0     1
     0     1     0     0
     0     0     1     0
     1     0     0     0


The L matrix is:
   1.000000000000000                   0                   0                   0
                   0   1.000000000000000                   0                   0
   0.500000000000000   1.000000000000000   1.000000000000000                   0
                   0  -1.000000000000000                   0   1.000000000000000


The U matrix is:
   2.000000000000000                   0   1.000000000000000                   0
                   0   1.000000000000000                   0   1.000000000000000
                   0                   0   1.500000000000000  -1.000000000000000
                   0                   0                   0   2.000000000000000


ans =

   0.333333333333333
                   0
   0.333333333333333
   1.000000000000000

det(Q)

ans =

    -6

diary off
